<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Prompt Builder - Multilingual</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
<div class="container mx-auto px-4 py-8 max-w-4xl">
    <!-- Header -->
    <div class="text-center mb-8">
        <div class="flex items-center justify-between mb-4">
            <div class="flex-1"></div>
            <div class="flex items-center gap-3">
                <!-- Settings Button -->
                <button onclick="toggleSettings()" id="settingsBtn"
                        class="flex items-center gap-2 bg-white border rounded-lg px-3 py-2 hover:bg-gray-50">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                    </svg>
                    <span id="settingsText">âš™ï¸ Settings</span>
                </button>

                <select id="langSelect" class="bg-white border rounded-lg px-3 py-2">
                    <option value="en">ğŸ‡ºğŸ‡¸ English</option>
                    <option value="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
                    <option value="id">ğŸ‡®ğŸ‡© Bahasa Indonesia</option>
                    <option value="ar">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                </select>
            </div>
        </div>
        <h1 id="title" class="text-5xl font-bold text-gray-800 mb-4"></h1>
        <p id="subtitle" class="text-lg text-gray-600"></p>
    </div>

    <!-- API Key Settings -->
    <div id="apiKeySection" class="bg-yellow-50 border-2 border-yellow-300 rounded-2xl p-6 mb-8" style="display:none;">
        <div class="flex justify-between items-start mb-3">
            <h3 class="text-lg font-bold">âš™ï¸ API Key Settings</h3>
            <button onclick="toggleSettings()" class="text-gray-500 hover:text-gray-700">âœ•</button>
        </div>

        <!-- Current API Key Display -->
        <div id="currentKey" style="display:none;" class="mb-4 p-3 bg-white rounded-lg border">
            <p class="text-xs text-gray-500 mb-2">Current API Key:</p>
            <div class="flex items-center gap-2">
                <input type="password" id="displayKey" readonly
                       class="flex-1 text-sm font-mono bg-transparent"/>
                <button onclick="toggleShow()"
                        class="px-3 py-1 text-sm bg-gray-100 rounded hover:bg-gray-200">ğŸ‘ï¸ Show
                </button>
                <button onclick="deleteKey()"
                        class="px-3 py-1 text-sm bg-red-100 text-red-600 rounded hover:bg-red-200">ğŸ—‘ï¸ Delete
                </button>
            </div>
        </div>

        <p class="text-sm mb-3">Get FREE API key from Google Gemini:</p>
        <ol class="text-sm mb-4 list-decimal list-inside space-y-1">
            <li>Open:
                <a href="https://aistudio.google.com/app/apikey" target="_blank"
                   class="text-blue-600 font-bold underline">Google AI Studio</a>
            </li>
            <li>Login &amp; click "Create API Key"</li>
            <li>Copy &amp; paste below:</li>
        </ol>
        <div class="flex gap-2">
            <input type="password" id="apiKeyInput" placeholder="Paste your API key here..."
                   class="flex-1 px-4 py-2 border rounded-lg">
            <button onclick="saveKey()"
                    class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg font-semibold">ğŸ’¾ Save
            </button>
        </div>
        <p class="text-xs text-gray-500 mt-2">âœ… Stored locally in your browser (safe &amp; private)</p>
    </div>

    <!-- Main Content -->
    <div class="bg-white rounded-2xl shadow-xl p-8 mb-8">
        <!-- Prompt Category -->
        <div class="mb-4">
            <label id="categoryLabel" class="block text-base font-semibold mb-2"></label>
            <select id="categorySelect"
                    class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                <option value="general">General / Umum</option>
                <option value="email">Email / Komunikasi</option>
                <option value="coding">Coding / Programming</option>
                <option value="marketing">Marketing / Copywriting</option>
                <option value="translation">Terjemahan / Translation</option>
                <option value="summary">Ringkasan / Summary</option>
            </select>
        </div>

        <div class="mb-8">
            <label id="inputLabel" class="block text-lg font-semibold mb-3"></label>
            <textarea id="ideaInput"
                      class="w-full h-32 p-4 border rounded-lg resize-none focus:ring-2 focus:ring-blue-500"></textarea>
        </div>

        <div class="flex flex-col md:flex-row justify-center items-center gap-3 text-center mb-8">
            <button onclick="generate()" id="generateBtn"
                    class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-8 rounded-lg text-lg disabled:bg-gray-400 w-full md:w-auto">
                <span id="btnText"></span>
            </button>
            <button onclick="clearAll()" id="clearBtn"
                    class="border border-gray-300 bg-white hover:bg-gray-50 text-gray-700 font-semibold py-3 px-8 rounded-lg text-base w-full md:w-auto">
                <span id="clearText"></span>
            </button>
        </div>

        <div id="outputSection" style="display:none;">
            <div class="flex justify-between mb-3">
                <label id="outputLabel" class="text-lg font-semibold"></label>
                <button onclick="copyOutput()"
                        class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg">
                    <span id="copyText"></span>
                </button>
            </div>
            <div id="output"
                 class="bg-gray-50 border rounded-lg p-4 min-h-[120px] whitespace-pre-wrap"></div>
        </div>
    </div>

    <footer class="text-center text-gray-500">
        <span id="footer"></span>
    </footer>
</div>

<script>
    // ================== i18n Text ==================
    const T = {
        ja: {
            title: "AIãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ“ãƒ«ãƒ€ãƒ¼",
            subtitle: "ã‚ãªãŸã®ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’åŠ¹æœçš„ãªAIãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«å¤‰æ›ã—ã¾ã™",
            inputLabel: "ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„",
            inputPlaceholder: "ã“ã“ã«ã‚ãªãŸã®ã‚¢ã‚¤ãƒ‡ã‚¢ã‚„è¦æ±‚ã‚’æ—¥æœ¬èªã§å…¥åŠ›ã—ã¦ãã ã•ã„...",
            generateButton: "ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆ",
            outputLabel: "ç”Ÿæˆã•ã‚ŒãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ",
            copyButton: "ã‚³ãƒ”ãƒ¼",
            copied: "ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼",
            generating: "ç”Ÿæˆä¸­...",
            footer: "Design by Wahyu",
            categoryLabel: "ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ã‚«ãƒ†ã‚´ãƒªï¼ˆå†…å®¹ï¼‰",
            clearButton: "ã‚¯ãƒªã‚¢"
        },
        en: {
            title: "AI Prompt Builder",
            subtitle: "Transform your ideas into effective AI prompts",
            inputLabel: "Enter your idea",
            inputPlaceholder: "Enter your idea here...",
            generateButton: "Generate Prompt",
            outputLabel: "Generated Prompt",
            copyButton: "Copy",
            copied: "Copied!",
            generating: "Generating...",
            footer: "Design by Wahyu",
            categoryLabel: "Prompt category (what it's about)",
            clearButton: "Clear"
        },
        id: {
            title: "Pembuat Prompt AI",
            subtitle: "Ubah ide Anda menjadi prompt AI yang efektif",
            inputLabel: "Masukkan ide Anda",
            inputPlaceholder: "Masukkan ide Anda...",
            generateButton: "Buat Prompt",
            outputLabel: "Prompt yang Dihasilkan",
            copyButton: "Salin",
            copied: "Tersalin!",
            generating: "Membuat...",
            footer: "Design by Wahyu",
            categoryLabel: "Kategori prompt (tentang apa)",
            clearButton: "Clear"
        },
        ar: {
            title: "Ù…Ù†Ø´Ø¦ Ø§Ù„Ù…Ø·Ø§Ù„Ø¨Ø§Øª Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ",
            subtitle: "Ø­ÙˆÙ‘Ù„ Ø£ÙÙƒØ§Ø±Ùƒ Ø¥Ù„Ù‰ Ù…Ø·Ø§Ù„Ø¨Ø§Øª ÙØ¹Ø§Ù„Ø© Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ",
            inputLabel: "Ø£Ø¯Ø®Ù„ ÙÙƒØ±ØªÙƒ",
            inputPlaceholder: "Ø£Ø¯Ø®Ù„ ÙÙƒØ±ØªÙƒ...",
            generateButton: "Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø·Ø§Ù„Ø¨Ø©",
            outputLabel: "Ø§Ù„Ù…Ø·Ø§Ù„Ø¨Ø© Ø§Ù„Ù…ÙÙ†Ø´Ø£Ø©",
            copyButton: "Ù†Ø³Ø®",
            copied: "ØªÙ… Ø§Ù„Ù†Ø³Ø®!",
            generating: "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡...",
            footer: "ØªØµÙ…ÙŠÙ… Ø¨ÙˆØ§Ø³Ø·Ø© ÙˆØ­ÙŠÙˆ",
            categoryLabel: "ÙØ¦Ø© Ø§Ù„Ø·Ù„Ø¨ (Ø¹Ù† Ù…Ø§Ø°Ø§ØŸ)",
            clearButton: "Ù…Ø³Ø­"
        }
    };

    // System prompt per language
    const S = {
        ja: "ã‚ãªãŸã¯å„ªç§€ãªAIãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã§ã™ã€‚",
        en: "You are an expert AI prompt engineer.",
        id: "Anda adalah ahli prompt engineer.",
        ar: "Ø£Ù†Øª Ù…Ù‡Ù†Ø¯Ø³ Ù…Ø·Ø§Ù„Ø¨Ø§Øª Ø®Ø¨ÙŠØ±."
    };

    // Model yang masih aktif
    const GEMINI_MODEL = "gemini-2.5-flash";

    // Deskripsi kategori per bahasa (program / tentang apa)
    const CATEGORY_HINTS = {
        general: {
            en: "General purpose prompt. Help structure and clarify the user's idea.",
            id: "Prompt umum. Bantu menyusun dan memperjelas ide pengguna.",
            ja: "æ±ç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’æ•´ç†ã—ã€åˆ†ã‹ã‚Šã‚„ã™ãã—ã¦ãã ã•ã„ã€‚",
            ar: "Ù…Ø·Ù„Ø¨ Ø¹Ø§Ù…. Ø³Ø§Ø¹Ø¯ ÙÙŠ ØªÙ†Ø¸ÙŠÙ… ÙˆØªÙˆØ¶ÙŠØ­ ÙÙƒØ±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…."
        },
        email: {
            en: "Create a clear, polite email based on the user's idea.",
            id: "Buat email yang jelas dan sopan berdasarkan ide pengguna.",
            ja: "ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¢ã‚¤ãƒ‡ã‚¢ã«åŸºã¥ã„ã¦ã€ä¸å¯§ã§åˆ†ã‹ã‚Šã‚„ã™ã„ãƒ¡ãƒ¼ãƒ«ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚",
            ar: "Ø£Ù†Ø´Ø¦ Ø±Ø³Ø§Ù„Ø© Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙˆØ§Ø¶Ø­Ø© ÙˆÙ…Ù‡Ø°Ø¨Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ÙÙƒØ±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…."
        },
        coding: {
            en: "Help the user with programming-related prompts and code explanations.",
            id: "Bantu pengguna membuat prompt terkait pemrograman dan penjelasan kode.",
            ja: "ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã«é–¢ã™ã‚‹ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚„ã‚³ãƒ¼ãƒ‰ã®èª¬æ˜ã‚’æ‰‹åŠ©ã‘ã—ã¦ãã ã•ã„ã€‚",
            ar: "Ø³Ø§Ø¹Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„Ù…Ø·Ø§Ù„Ø¨Ø§Øª Ø§Ù„Ù…ØªØ¹Ù„Ù‚Ø© Ø¨Ø§Ù„Ø¨Ø±Ù…Ø¬Ø© ÙˆØ´Ø±Ø­ Ø§Ù„Ø´ÙŠÙØ±Ø©."
        },
        marketing: {
            en: "Write marketing or copywriting style prompts to promote products or services.",
            id: "Tulis prompt bergaya marketing / copywriting untuk mempromosikan produk atau jasa.",
            ja: "å•†å“ã‚„ã‚µãƒ¼ãƒ“ã‚¹ã‚’å®£ä¼ã™ã‚‹ãŸã‚ã®ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ï¼ã‚³ãƒ”ãƒ¼ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°é¢¨ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚",
            ar: "Ø§ÙƒØªØ¨ Ù…Ø·Ø§Ù„Ø¨Ø§Øª Ø¨Ø£Ø³Ù„ÙˆØ¨ ØªØ³ÙˆÙŠÙ‚ÙŠ Ø£Ùˆ ÙƒØªØ§Ø¨Ø© Ø¥Ø¹Ù„Ø§Ù†ÙŠØ© Ù„Ù„ØªØ±ÙˆÙŠØ¬ Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª Ø£Ùˆ Ø§Ù„Ø®Ø¯Ù…Ø§Øª."
        },
        translation: {
            en: "Focus on translation, preserving meaning, tone, and important terminology.",
            id: "Fokus pada terjemahan sambil menjaga makna, nada, dan istilah penting.",
            ja: "ç¿»è¨³ã«é›†ä¸­ã—ã€æ„å‘³ãƒ»ãƒˆãƒ¼ãƒ³ãƒ»é‡è¦ãªç”¨èªã‚’ç¶­æŒã—ã¦ãã ã•ã„ã€‚",
            ar: "Ø±ÙƒØ² Ø¹Ù„Ù‰ Ø§Ù„ØªØ±Ø¬Ù…Ø© Ù…Ø¹ Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¹Ù†Ù‰ ÙˆØ§Ù„Ù†Ø¨Ø±Ø© ÙˆØ§Ù„Ù…ØµØ·Ù„Ø­Ø§Øª Ø§Ù„Ù…Ù‡Ù…Ø©."
        },
        summary: {
            en: "Summarize the content clearly and concisely for the user.",
            id: "Ringkas isi secara jelas dan padat untuk pengguna.",
            ja: "å†…å®¹ã‚’åˆ†ã‹ã‚Šã‚„ã™ãç°¡æ½”ã«è¦ç´„ã—ã¦ãã ã•ã„ã€‚",
            ar: "Ù„Ø®Ù‘Øµ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¨ÙˆØ¶ÙˆØ­ ÙˆØ§Ø®ØªØµØ§Ø± Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…."
        }
    };

    let L = "en";

    function updateLanguage() {
        L = document.getElementById("langSelect").value;
        const t = T[L];

        document.getElementById("title").textContent = t.title;
        document.getElementById("subtitle").textContent = t.subtitle;
        document.getElementById("inputLabel").textContent = t.inputLabel;
        document.getElementById("ideaInput").placeholder = t.inputPlaceholder;
        document.getElementById("btnText").textContent = t.generateButton;
        document.getElementById("outputLabel").textContent = t.outputLabel;
        document.getElementById("copyText").textContent = t.copyButton;
        document.getElementById("footer").textContent = t.footer;
        document.getElementById("categoryLabel").textContent = t.categoryLabel;
        document.getElementById("clearText").textContent = t.clearButton;

        document.getElementById("ideaInput").dir = L === "ar" ? "rtl" : "ltr";
        document.getElementById("output").dir = L === "ar" ? "rtl" : "ltr";
    }

    function toggleSettings() {
        const s = document.getElementById("apiKeySection");
        s.style.display = (s.style.display === "none" || s.style.display === "") ? "block" : "none";
        updateDisplay();
    }

    function updateDisplay() {
        const k = localStorage.getItem("gak");
        const d = document.getElementById("currentKey");
        const i = document.getElementById("displayKey");
        const st = document.getElementById("settingsText");

        if (k) {
            d.style.display = "block";
            i.value = k;
            st.textContent = "âœ… API Key";
        } else {
            d.style.display = "none";
            st.textContent = "âš ï¸ API Key";
        }
    }

    function toggleShow() {
        const i = document.getElementById("displayKey");
        i.type = (i.type === "password") ? "text" : "password";
    }

    function deleteKey() {
        if (confirm("Delete API key?")) {
            localStorage.removeItem("gak");
            document.getElementById("apiKeyInput").value = "";
            updateDisplay();
            alert("âœ… Deleted!");
        }
    }

    function saveKey() {
        const k = document.getElementById("apiKeyInput").value.trim();
        if (!k) {
            alert("âš ï¸ Enter API key!");
            return;
        }
        localStorage.setItem("gak", k);
        document.getElementById("apiKeySection").style.display = "none";
        alert("âœ… Saved!");
        updateDisplay();
    }

    async function generate() {
        const idea = document.getElementById("ideaInput").value.trim();
        const apiKey = localStorage.getItem("gak");

        if (!apiKey) {
            alert("âš ï¸ Setup API key first!");
            document.getElementById("apiKeySection").style.display = "block";
            return;
        }
        if (!idea) {
            alert("âš ï¸ Enter your idea!");
            return;
        }

        const btn = document.getElementById("generateBtn");
        btn.disabled = true;
        document.getElementById("btnText").textContent = T[L].generating;

        // ==== timeout 20 detik supaya tidak nyangkut ====
        const controller = new AbortController();
        const timeoutId = setTimeout(() => {
            controller.abort();
        }, 20000);

        try {
            const url =
                `https://generativelanguage.googleapis.com/v1beta/models/${GEMINI_MODEL}:generateContent`;

            const selectedCategory = document.getElementById("categorySelect").value;
            const categoryText =
                CATEGORY_HINTS[selectedCategory]?.[L]
                    ? "Category:\n" + CATEGORY_HINTS[selectedCategory][L] + "\n\n"
                    : "";

            const body = {
                contents: [
                    {
                        parts: [
                            {
                                text:
                                    S[L] +
                                    "\n\n" +
                                    categoryText +
                                    idea
                            }
                        ]
                    }
                ]
            };

            console.log("[AI Prompt Builder] Sending request to Geminiâ€¦", { model: GEMINI_MODEL });

            const res = await fetch(url, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "x-goog-api-key": apiKey
                },
                body: JSON.stringify(body),
                signal: controller.signal
            });

            const data = await res.json();
            console.log("[AI Prompt Builder] Response:", data);

            if (!res.ok) {
                const msg = data.error?.message || `HTTP ${res.status}`;
                throw new Error(msg);
            }

            const candidate = data.candidates && data.candidates[0];
            const parts = candidate?.content?.parts || [];
            const text = parts.map(p => p.text || "").join("").trim();

            if (!text) {
                throw new Error("Empty response from model.");
            }

            document.getElementById("output").textContent = text;
            document.getElementById("outputSection").style.display = "block";
        } catch (e) {
            if (e.name === "AbortError") {
                alert("â±ï¸ Request terlalu lama / jaringan lambat.\nCoba lagi, atau cek koneksi & blokir kantor/VPN.");
                console.error("[AI Prompt Builder] Timeout:", e);
            } else {
                alert("âŒ Error: " + e.message + "\n\nCek kembali API key, quota, atau Network tab di DevTools.");
                console.error("[AI Prompt Builder] Error:", e);
            }
        } finally {
            clearTimeout(timeoutId);
            btn.disabled = false;
            document.getElementById("btnText").textContent = T[L].generateButton;
        }
    }

    async function copyOutput() {
        try {
            const text = document.getElementById("output").textContent;
            await navigator.clipboard.writeText(text);
            const b = document.getElementById("copyText");
            const old = b.textContent;
            b.textContent = T[L].copied;
            setTimeout(() => b.textContent = old, 2000);
        } catch (e) {
            console.error(e);
        }
    }

    function clearAll() {
        // Bersihkan input ide
        document.getElementById("ideaInput").value = "";

        // Sembunyikan output
        document.getElementById("output").textContent = "";
        document.getElementById("outputSection").style.display = "none";

        // Reset kategori ke default (opsional)
        const cs = document.getElementById("categorySelect");
        if (cs) cs.value = "general";
    }

    // Init
    document.getElementById("langSelect").addEventListener("change", updateLanguage);
    updateLanguage();
    updateDisplay();

    if (!localStorage.getItem("gak")) {
        document.getElementById("apiKeySection").style.display = "block";
    }
</script>

</body>
</html>
